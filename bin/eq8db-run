#!/usr/bin/env node

'use strict';

const _ = require('lodash');
const program = require('commander');

const pkg = require('../package.json');

/**
 * Program Options
 */
program
	.description('Runs an instance of the eq8db worker')
  .version(pkg.version)
	.option('--dev', 'Flag development mode - i.e. run instance as both manager and worker')
	.option('--worker', 'Run instance as a worker')
	.option('--log-level <string>', 'The log level for the instance', /^(trace|debug|info|error)$/i)
	.option('--port <num>', 'The port to bind on', parseInt)
	.option('--api-path <string>', 'The API path - e.g. /api')
	.option('--db-host <string>', 'The hostname/IP address of the database')
	.option('--db-port <string>', 'The host port of the database')
  .parse(process.argv);

const options = _.pick(program, ['dev', 'worker', 'logLevel', 'port', 'apiPath']);
const eq8db = require('..');

eq8db(options);
